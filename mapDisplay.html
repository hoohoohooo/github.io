<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>간단한 지도 표시하기</title>
    <script src="../../docs/js/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="../../docs/js/examples-base.js"></script>
    <script type="text/javascript" src="../../docs/js/highlight.min.js"></script>
    <!-- ncpClientId는 등록 환경에 따라 일반(ncpClientId), 공공(govClientId), 금융(finClientId)으로 나뉩니다. 사용하는 환경에 따라 키 이름을 변경하여 사용하세요. 참고: clientId(네이버 개발자 센터)는 지원 종료 -->
    <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=mtvq1t3xt6"></script>
    <link rel="stylesheet" type="text/css" href="../../docs/css/examples-base.css" />
</head>
<body>

<!-- @category Map -->

<div id="wrap" class="section">
    <div id="map" style="width:100%;height:100%;"></div>
    <code id="snippet" class="snippet"></code>
</div>
<script id="code">
//지도를 삽입할 HTML 요소 또는 HTML 요소의 id를 지정합니다.
//var mapDiv = document.getElementById('map'); // 'map'으로 선언해도 동일
var map;
//loadMap('35.16\t129.12');

//var position = new naver.maps.LatLng(37.3595704, 127.105399);
//옵션 없이 지도 객체를 생성하면 서울 시청을 중심으로 하는 16 레벨의 지도가 생성됩니다.
//var map = new naver.maps.Map(mapDiv,{
//    center: position,
//    zoom: 15
//});
//var marker = new naver.maps.Marker({
//    position: position,
//    map: map
//});

//console.log(map.getCenter())
//const currentUrl = window.location.href;
//console.log(currentUrl);
//naver.maps.Event.addListener(map, 'tap', function(e) {
//    marker.setPosition(e.coord);
//    location.href = "uniwebview://action?key=value&anotherKey=anotherValue";
//});
    //loadMap();
    function loadMap(phonePosDataStr, jsonStr){
        location.href = "uniwebview://showing map...";
        var phonePos = phonePosDataStr.split("\t");
        //var x = parsFloat(phonePos[0]);
        //var y = parsFloat(phonePos[1]);
        var position = new naver.maps.LatLng(phonePos[0],phonePos[1]);
        var map = new naver.maps.Map(mapDiv,{
            center: position,
            zoom: 15
        });
        location.href = "uniwebview://showing map successful";
        location.href = "uniwebview://placing markers...";
        var shops = jsonStr.split("\n");
        var markers = [];
        for(let i = 0;i<shops.length;i++){
            var infoArr = shops[i].split("\t");
            console.log(infoArr[0]);
            var tmpMarker = new naver.maps.Marker({
                position: new naver.maps.LatLng(infoArr[1],infoArr[2]),
                map: map,
                title: shops[0]
            });
            naver.maps.Event.addListener(tmpMarker,"click",function(e){
                location.href = "uniwebview://" + tmpMarker.title;
            });
            markers.push(tmpMarker);
        }
    }

    function loadMap(){
        location.href = "uniwebview://showing map...0";
        var mapDiv = document.getElementById('map'); 
        location.href = "uniwebview://showing map...1";
        var position = new naver.maps.LatLng(37.3595704, 127.105399);
        location.href = "uniwebview://showing map...2";
        map = new naver.maps.Map(mapDiv,{
        center: position,
        zoom: 15
        });
        location.href = "uniwebview://showing map...3";
    }

    function setCenter(str){
        location.href = "uniwebview://setting center..." + "to " + str;
        var posArr = str.split('@');
        var position = new naver.maps.LatLng(posArr[0],posArr[1]);
        map.setCenter(position);
    }
    function uniWebViewCommunicationTest(str){
        location.href = "uniwebview://" + str;
    }
    function setMarker(str){
        var infoArr = str.split('\t');
        var tmpMarker = new naver.maps.Marker({
                position: new naver.maps.LatLng(infoArr[1],infoArr[2]),
                map: map,
                title: infoArr[0]
            });
        naver.maps.Event.addListener(tmpMarker,"click",function(e){
                location.href = "uniwebview://" + tmpMarker.title;
            });
            
    }
</script>

</body>
</html>
